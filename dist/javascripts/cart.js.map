{"version":3,"sources":["cart.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.js","sourcesContent":[";$(function(){\r\n    //渲染页面\r\n    function RenderPop(){};\r\n    $.extend(RenderPop.prototype,{\r\n        init(){\r\n            this.box=$(\".recommend-box\");\r\n            this.addCarbtn=$(\".cart-list\")\r\n            this.getDate();\r\n            this.bindEvent();\r\n        },\r\n        getDate(){\r\n            //当前页面的添加购物车\r\n            var options={\r\n                url:'https://tuijian.suning.com/recommend-portal/recommend/paramsBiz.jsonp?parameters=000000000161786163&cityId=010&sceneIds=10-23&count=40&u=&c=154341515643283540&flag=',\r\n                type:\"GET\",\r\n                dataType:\"jsonp\",\r\n            };\r\n            $.ajax(options)\r\n            .then(function(res){\r\n                var json=res.sugGoods[0].skus;\r\n                this.goodsJson=json;\r\n                this.rendePage(json);\r\n            }.bind(this));\r\n        },\r\n        //渲染页面\r\n        rendePage(data){\r\n            var html=\"\";\r\n            for(var i= 0;i<data.length;i++){\r\n                html+=`\r\n                <li class=\"product-box unlikeSign\">\r\n                <a href=\"javascriptL:void(0)\" class=\"product-pic unlikeASign\">\r\n                    <img class=\"product-img lazy-loading\" src=\"${data[i].pictureUrl}\" alt=\"\">\r\n                </a>\r\n                <p class=\"product-price-num\"><span class=\"sn-price clearfix\"><i class=\"price-icon l\">¥</i><em class=\"price-big l\">${data[i].price}</em></span><span class=\"product-num\"><em>72.3万</em>人已购买</span></p>\r\n                <p class=\"product-name\">\r\n                    <a href=\"javcascript:void(0)\">\r\n                            ${data[i].sugGoodsName}\r\n                    </a>\r\n                </p>\r\n                <a href=\"javascript:void(0)\" class=\"add-cart \" data-id=${data[i].promotionId}>\r\n                    <i></i>\r\n                    加入购物车\r\n                </a>\r\n            </li>\r\n                `\r\n            }\r\n            this.box.html(html);\r\n        },\r\n        //绑定事件\r\n        bindEvent(){\r\n            this.box.on(\"click\",\".add-cart\",this.handleCarClick.bind(this));\r\n            this.addCarbtn.on(\"click\",\".plus\",this.addCount);\r\n            this.addCarbtn.on(\"click\",\".minus\",this.reduceCount);\r\n        },\r\n        //增加已有商品数量\r\n        addCount(){\r\n            var goods=getCart();\r\n            var btnId=$(this).attr(\"btn-id\");\r\n            for(var i=0;i<goods.length;i++){\r\n                if(goods[i].promotionId === btnId){\r\n                    goods[i].count++;\r\n                    localStorage.cart1=JSON.stringify(goods);\r\n                    $(this).siblings(\"input\").val(goods[i].count);\r\n                    allPrice=goods[i].count*goods[i].price;\r\n                    $(this).parents(\".td-amount\").siblings(\".td-sum\").find(\"em\").html(allPrice); \r\n                    loading();                    \r\n                }\r\n            }\r\n        },\r\n        //减少已有商品数量\r\n        reduceCount(){\r\n            var goods=getCart();\r\n            var btnId=$(this).attr(\"btn-iid\");\r\n            for(var i=0;i<goods.length;i++){\r\n                if(goods[i].promotionId === btnId){\r\n                    goods[i].count--;\r\n                    if(goods[i].count>=1){\r\n                        localStorage.cart1=JSON.stringify(goods);\r\n                        $(this).siblings(\"input\").val(goods[i].count);\r\n                        allPrice=goods[i].count*goods[i].price;\r\n                        $(this).parents(\".td-amount\").siblings(\".td-sum\").find(\"em\").html(allPrice); \r\n                        loading();                                            \r\n                    }else{\r\n                        alert(\"小姐姐，小哥哥，别再减了哦^-^ 再减就没了！\")\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        //增加购物车触发事件\r\n        handleCarClick(event){\r\n            var e=event||window.event;\r\n            var target=e.target||e.srcElement;\r\n            var promotionId=$(target).attr(\"data-id\");\r\n            var nowMsg=this.findJson(promotionId)[0];\r\n            this.addCar(nowMsg,promotionId);\r\n        },\r\n        //查找符合当前promotionId的元素，并返回；\r\n        findJson(promotionId){\r\n            return this.goodsJson.filter(function(item){\r\n                return item.promotionId === promotionId;\r\n            })\r\n        }\r\n        ,\r\n        //增加购物车\r\n        addCar(nowMsg,promotionId){\r\n            $.extend(nowMsg,{count:1});\r\n            var sNowMsg = JSON.stringify(nowMsg);\r\n\r\n            if(!localStorage.cart1){\r\n                localStorage.setItem(\"cart1\",`[${sNowMsg}]`)\r\n                return false;\r\n            };\r\n            var aMsg=JSON.parse(localStorage.cart1);\r\n            if(!this.hasId(aMsg,promotionId)){\r\n                aMsg.push(nowMsg);\r\n            }\r\n            localStorage.setItem(\"cart1\",JSON.stringify(aMsg));\r\n            renderCart();\r\n            loading();\r\n        },\r\n        //找寻数组中是否存在\r\n        hasId(aMsg,promotionId){\r\n            for(var i=0;i<aMsg.length;i++){\r\n                if(aMsg[i].promotionId===promotionId){\r\n                    aMsg[i].count++;\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        \r\n       \r\n    });\r\n    new RenderPop().init();\r\n\r\n    //总数据改变\r\n    function loading(){\r\n        var numbox =$(\".td-sum em\");\r\n        var num=0;\r\n        for(var i=0;i<numbox.length;i++){\r\n            num+=Number($(\".td-sum em\").eq(i).html()) \r\n        }\r\n        $(\"#cart1PayAmount\").html(num)\r\n    }\r\n    //获取本地储存的商品，返回数组\r\n    function getCart(){\r\n        if(!localStorage.cart1) return 0;\r\n        var aMsg=JSON.parse(localStorage.cart1);\r\n        return aMsg;\r\n    }\r\n    //渲染购物车\r\n    function renderCart(){\r\n        var html=\"\";\r\n            var cart_json=getCart();\r\n            if(!cart_json) return 0;\r\n            for(var i=0;i<cart_json.length;i++){\r\n                html+=`\r\n                <div class=\"item \">\r\n                    <div class=\"item-main clearfix\">\r\n                        <div class=\"td td-chk from\">\r\n                            <div class=\"cart-checkbox\">\r\n                                <input type=\"checkbox\" id=\"sp\" class=\"checkbox chk-item\">\r\n                                <label for=\"sp\"></label>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"td td-item\">\r\n                            <div class=\"item-pic\">\r\n                                <a href=\"javascript:void(0)\" class=\"item-img-box\">\r\n                                    <img src=\"${cart_json[i].pictureUrl}\" alt=\"\">\r\n                                </a>\r\n                            </div>\r\n                            <div class=\"item-info\">\r\n                                <a href=\"javascript:void(0)\" class=\"item-title\">\r\n                                ${cart_json[i].sugGoodsName}    </a>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"td td-price\">\r\n                            <div class=\"price-line\">\r\n                                <span class=\"price-now sn-price\">\r\n                                    <i>¥</i>\r\n                                    <em> ${cart_json[i].price}  </em>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"td td-amount\">\r\n                            <div class=\"item-amount\">\r\n                                <a href=\"javascript:;\" class=\"minus no-minus\" btn-iid=\"${cart_json[i].promotionId}\">-</a>\r\n                                <input type=\"text\" class=\"ui-text text-amount\" value=\"${cart_json[i].count}\">\r\n                                <a href=\"javascript:;\" class=\"plus\" btn-id=\"${cart_json[i].promotionId}\">+</a>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"td td-sum\">\r\n                            <b class=\"sn-price\">\r\n                                <i>¥</i>\r\n                                <em>${cart_json[i].price * cart_json[i].count}</em>\r\n                            </b>\r\n                            <p class=\"pro-weight\">0.15kg</p>\r\n                        </div>\r\n                        <div class=\"td td-op\">\r\n                            <a href=\"javascript:void(0)\" class=\"add-fav tip-common-click-fn-btn\">移入收藏</a>\r\n                            <a href=\"javascript:void(0)\" class=\"del tip-common-click-fn-btn\">删除</a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                `\r\n            }\r\n            $(\".cart-list\").html(html);\r\n            loading();\r\n    }\r\n    renderCart();\r\n\r\n    //清空购物车\r\n    function clearCart(){\r\n      localStorage.clear(\"cart1\");\r\n    }\r\n\r\n\r\n    //获取本地储存的商品，返回数组其他页面添加\r\n    function getCartOther(){\r\n        if(!localStorage.cart2) return 0;\r\n        var aMsg=JSON.parse(localStorage.cart2);\r\n        return aMsg;\r\n    }\r\n    function renderCartOther(){\r\n        var html=\"\";\r\n        var cart_json=getCartOther();\r\n        if(!cart_json) return 0;\r\n        for(var i=0;i<cart_json.length;i++){\r\n            html+=`\r\n            <div class=\"item \">\r\n                <div class=\"item-main clearfix\">\r\n                    <div class=\"td td-chk from\">\r\n                        <div class=\"cart-checkbox\">\r\n                            <input type=\"checkbox\" id=\"sp\" class=\"checkbox chk-item\">\r\n                            <label for=\"sp\"></label>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"td td-item\">\r\n                        <div class=\"item-pic\">\r\n                            <a href=\"javascript:void(0)\" class=\"item-img-box\">\r\n                                <img src=\"${cart_json[i].adSrc}\" alt=\"\">\r\n                            </a>\r\n                        </div>\r\n                        <div class=\"item-info\">\r\n                            <a href=\"javascript:void(0)\" class=\"item-title\">\r\n                            ${cart_json[i].title}    </a>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"td td-price\">\r\n                        <div class=\"price-line\">\r\n                            <span class=\"price-now sn-price\">\r\n                                <i>¥</i>\r\n                                <em> ${cart_json[i].tPrice}  </em>\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"td td-amount\">\r\n                        <div class=\"item-amount\">\r\n                            <a href=\"javascript:;\" class=\"minus no-minus\" btn-iid=\"${cart_json[i].sid}\">-</a>\r\n                            <input type=\"text\" class=\"ui-text text-amount\" value=\"${cart_json[i].count}\">\r\n                            <a href=\"javascript:;\" class=\"plus\" btn-id=\"${cart_json[i].sid}\">+</a>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"td td-sum\">\r\n                        <b class=\"sn-price\">\r\n                            <i>¥</i>\r\n                            <em></em>\r\n                        </b>\r\n                        <p class=\"pro-weight\">0.15kg</p>\r\n                    </div>\r\n                    <div class=\"td td-op\">\r\n                        <a href=\"javascript:void(0)\" class=\"add-fav tip-common-click-fn-btn\">移入收藏</a>\r\n                        <a href=\"javascript:void(0)\" class=\"del tip-common-click-fn-btn\">删除</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            `\r\n        }\r\n        $(\".cart-list\").html(($(\".cart-list\").html()+html));\r\n        onetoTallPrice();\r\n    }\r\n    renderCartOther();\r\n   \r\n    //减少商品的时候触发\r\n    function cursor(){\r\n        if($(\".cart-list\").find(\".text-amount\").val()>1){\r\n            $(\".cart-list\").find(\".no-minus\").css(\"cursor\",\"pointer\");\r\n        }else{\r\n                $(\".cart-list\").find(\".no-minus\").css(\"cursor\",\"no-drop\");\r\n        }\r\n    }\r\n\r\n   \r\n})\r\n\r\n\r\n\r\n"]}